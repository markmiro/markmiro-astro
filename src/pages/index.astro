---
import About from "@components/About.astro";
import PostWrapper from "@components/PostWrapper.astro";
import ProjectImage from "@components/ProjectImage.astro";
import ProjectItemDate from "@components/ProjectItemDate.astro";
import Tools from "@components/Tools.astro";
import Layout from "@layouts/Layout.astro";
import { compareFrontmatterDateDesc } from "@lib/compareFrontmatterDateDesc";
import { extractLastUrlPathItem } from "@lib/extractLastUrlPathItem";
import { allExperiments, reference } from "@lib/_content";
const title = "Index";

const allProjects = await Astro.glob<Frontmatter>("./projects/*.mdx");
---

<Layout title={title}>
  <PostWrapper>
    <h1>Projects</h1>

    <div class="not-prose grid lg:grid-cols-2 gap-8">
      {
        allProjects
          .filter((p) => p.frontmatter?.draft !== true)
          .sort(compareFrontmatterDateDesc)
          .map((page) => (
            <a href={page.url} class="block hover:-translate-y-1 transition-transform">
              <div class="font-bold mb-2">
                <div>

                  {page.frontmatter.title}
                </div>
                {page.frontmatter?.date && (
                  <ProjectItemDate date={page.frontmatter?.date} />
                )}
              </div>
              <ProjectImage slug={extractLastUrlPathItem(page.url)} />
              {page.frontmatter?.description && (
                <div class="text-sm text-center my-1 leading-snug text-gray-500">
                  {page.frontmatter.description}
                </div>
              )}
            </a>
          ))
      }
    </div>
    <hr />
    <h1>Experiments</h1>
    <ul>
      {
        allExperiments
          .filter((ex) => ex?.draft !== true)
          .map((ex) => (
            <li>
              <div>
                {ex?.emoji && <span class="mr-2">{ex.emoji}</span>}
                {ex.title}
              </div>
              {ex?.description && (
                <div class="text-gray-500">{ex.description}</div>
              )}

              {ex?.date && (
                <time class="block text-gray-500 text-sm" datetime={ex.date}>
                  {ex.date}
                </time>
              )}
              <a
                href={ex.primaryLink}
                class="no-underline text-sm px-2 py-1 rounded-md bg-black hover:bg-neutral-700 text-white"
              >
                {ex.primaryLinkText} ↗
              </a>
            </li>
          ))
      }
    </ul>
    <hr />
    <h1>Reference</h1>
    <ul>
      {
        reference.map((r) => (
          <li>
            <a href={r.url} class="">
              {r.title} ↗
            </a>
          </li>
        ))
      }
    </ul>
    <hr />
    <h1>Tools</h1>
    <Tools />
  </PostWrapper>
</Layout>
